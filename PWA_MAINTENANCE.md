# üõ°Ô∏è PWA Protection & Maintenance Guide

## The Core Problem
AI code generators often regenerate PWA files using outdated patterns or strip away essential error handling, breaking offline functionality and installation prompts.

## üîí Protected Files
The following files are **LOCKED** and should not be regenerated by AI:

1.  **`sw.js`** (Root Service Worker)
    *   Contains critical cache-busting logic (`CACHE_VERSION` with timestamp).
    *   Manages the `skipWaiting` and `clients.claim` lifecycle.
    *   **Risk:** AI often replaces this with a generic service worker that doesn't update immediately.

2.  **`hooks/usePWAInstall.ts`**
    *   Manages the `beforeinstallprompt` event.
    *   Handles the "Install App" UI state and iOS detection.
    *   **Risk:** AI may remove the `preventDefault()` call, blocking the custom install UI.

3.  **`public/manifest.json`**
    *   Contains app identity, theme colors, and icons.
    *   **Risk:** AI regenerates this with missing icons or incorrect `start_url`.

## üõ†Ô∏è How to Modify PWA Features

### ‚úÖ DO:
*   Edit these files **manually** in your code editor.
*   Use `git diff` to verify changes before committing.
*   Run `node scripts/verify-pwa.js` to ensure integrity.

### ‚ùå DO NOT:
*   Ask AI to "Refactor the service worker".
*   Ask AI to "Update the install hook".
*   Allow AI to regenerate `manifest.json`.

## üö® Recovery Procedure

If AI Studio accidental breaks the PWA:

1.  **Check Status:**
    ```bash
    git status
    ```

2.  **Restore Critical Files:**
    ```bash
    git checkout main -- sw.js hooks/usePWAInstall.ts public/manifest.json
    ```

3.  **Verify Integrity:**
    ```bash
    node scripts/verify-pwa.js
    ```

## deployment Checklist

Before deploying, ensure:
1.  `sw.js` has a new `CACHE_VERSION` (or auto-timestamp is active).
2.  `manifest.json` icons are present in `public/`.
3.  The app installs correctly on a test device.
